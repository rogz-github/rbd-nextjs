// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema
// Updated: 2025-09-25 - Removed paypalOrderId field

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int       @id @default(autoincrement())
  firstName         String
  lastName          String
  username          String    @unique
  email             String    @unique
  emailVerifiedAt   DateTime?
  password          String
  rememberToken     String?
  image             String?
  role              Role      @default(USER)
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
}

model Product {
  id                String    @id @default(cuid())
  spuNo             String    @unique @map("spu_no")
  itemNo            String?   @unique @map("item_no")
  slug              String    @unique
  fullCategory      String    @map("full_category")
  category1         String    @map("category_1")
  category2         String?   @map("category_2")
  category3         String?   @map("category_3")
  category4         String?   @map("category_4")
  name              String
  supplier          String?
  brand             String?
  vt1               String?   @map("vt1")
  vv1               String?   @map("vv1")
  vt2               String?   @map("vt2")
  vv2               String?   @map("vv2")
  sku               String?   @unique
  msrp              Decimal?  @db.Decimal(10, 2)
  salePrice         Decimal?  @db.Decimal(10, 2) @map("sale_price")
  discountedPrice   Decimal?  @db.Decimal(10, 2) @map("discounted_price")
  dropshippingPrice Decimal?  @db.Decimal(10, 2) @map("dropshipping_price")
  map               String?
  inventory         String    @default("0")
  inventoryLoc      String?   @map("inventory_loc")
  shippingMethod    String?   @map("shipping_method")
  shipTo            String?   @map("ship_to")
  shippingCost      String    @default("0") @map("shipping_cost")
  promotionStart    String?   @map("promotion_start")
  promotionEnd      String?   @map("promotion_end")
  mainImage         String    @map("main_image")
  images            Json?     // JSON array of image URLs
  description       String?   @db.Text
  shortDescription  String?   @db.Text @map("short_description")
  upc               String?
  asin              String?
  processingTime    String?   @map("processing_time")
  ean               String?
  dsFrom            String?   @map("ds_from")
  dealId            String?   @map("deal_id")
  status            String    @default("active")
  metaTitle         String?   @map("meta_title")
  metaDescription   String?   @db.Text @map("meta_description")
  metaKeywords      String?   @map("meta_keywords")
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt

  @@index([spuNo])
  @@index([itemNo])
  @@index([slug])
  @@index([fullCategory])
  @@index([category1])
  @@index([category2])
  @@index([category3])
  @@index([category4])
  @@index([name])
  @@index([supplier])
  @@index([brand])
  @@index([vt1])
  @@index([vv1])
  @@index([vt2])
  @@index([vv2])
  @@index([sku])
  @@index([salePrice])
  @@index([discountedPrice])
  @@index([dropshippingPrice])
  @@index([map])
  @@index([dsFrom])
  @@index([status])
}

model Cart {
  id           String   @id @default(cuid())
  userType     String   @default("guest") @map("user_type")
  userId       Int      @map("user_id")
  prodId       String   @map("prod_id")
  prodQuantity Int      @map("prod_quantity")
  status       String   @default("active")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([userId])
  @@index([prodId])
  @@index([status])
}

model Order {
  // Primary key
  coId                    Int      @id @default(autoincrement()) @map("co_id")
  
  // Order identification
  coOrderId               String   @map("co_order_id") @db.VarChar(1000)
  coUserId                Int      @map("co_user_id")
  
  // Order details
  coType                  String   @map("co_type") @db.VarChar(1000)
  coNotes                 String   @map("co_notes") @db.Text
  
  // Pricing
  coSubtotal              Decimal  @map("co_subtotal") @db.Decimal(10, 2)
  coTotalDiscount         Decimal  @map("co_total_discount") @db.Decimal(10, 2)
  coTotalPrice            Decimal  @map("co_total_price") @db.Decimal(10, 2)
  
  // Payment
  coPaymentType           String   @map("co_payment_type") @db.VarChar(1000)
  
  // Status and dates
  coStatus                String   @map("co_status") @default("Pending") @db.VarChar(1000)
  coPendingDate           String?  @map("co_pending_date") @db.VarChar(1000)
  coProcessingDate        String?  @map("co_processing_date") @db.VarChar(1000)
  coDeliveredDate         String?  @map("co_delivered_date") @db.VarChar(1000)
  coCancelledDate         String?  @map("co_cancelled_date") @db.VarChar(1000)
  coCreated               String   @map("co_created") @db.VarChar(1000)
  
  // Additional fields
  coStyle                 String   @map("co_style") @default("new") @db.VarChar(5)
  coCoupoUsed             String?  @map("co_coupo_used") @db.VarChar(55)
  coCouponDiscount        String?  @map("co_coupon_discount") @db.VarChar(55)
  coUpdatedStatusTo       String?  @map("co_updated_status_to") @db.VarChar(100)
  coUpdatedStatusDate     String?  @map("co_updated_status_date") @db.VarChar(100)
  
  // Order data
  orderItems              String   @map("order_items") @default("[]") @db.Text
  shippingAddress         String   @map("shipping_address") @default("{}") @db.Text
  billingAddress          String   @map("billing_address") @default("{}") @db.Text
  totalItems              Int      @map("total_items") @default(0)
  
  // PayPal response
  paypalResponse          String?  @map("paypal_response") @db.Text
  
  // Timestamps
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt

  @@index([coOrderId])
  @@index([coUserId])
  @@index([coStatus])
}

enum Role {
  USER
  ADMIN
  SUPER_ADMIN
}